"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7874],{7874:(j,f,c)=>{c.r(f),c.d(f,{HerramientasModule:()=>E});var g=c(9808),r=c(5056),p=c(6852),d=c(655),e=c(6435),m=c(2340),h=c(520);let v=(()=>{class n{constructor(t){this.http=t,this.url=m.N.inventarioUTAPI+"herramientas/"}getHerramientas(){return this.http.get(this.url)}getHerramienta(t){return this.http.get(this.url+t)}getHerramientasPorIdTaller(t){return this.http.get(this.url+"taller/"+t)}postHerramienta(t){return this.http.post(this.url,t)}putHerramienta(t,i){return this.http.put(this.url+t,i)}deleteHerramienta(t){return this.http.delete(this.url+t)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Z=(()=>{class n{constructor(t){this.alertController=t}presentAlert(t,i,o){return(0,d.mG)(this,void 0,void 0,function*(){const s=yield this.alertController.create({cssClass:t,header:i,subHeader:o,buttons:["Ok"]});yield s.present();const{role:l}=yield s.onDidDismiss();console.log("onDidDismiss resolved with role",l)})}presentAlertOptions(t,i,o,s){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({cssClass:o,header:t,subHeader:i,buttons:s})).present()})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(r.Br))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var T=c(4023),A=c(7845),C=c(4159);let x=(()=>{class n{constructor(t){this.http=t,this.url=m.N.inventarioUTAPI+"rolusuarios/"}getRolUsuario(t){return this.http.get(this.url+t)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function S(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col",11)(2,"ion-button",12),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit,s=e.oxw();return e.KtG(s.editarHerramienta(o.idHerramienta))}),e._uU(3," editar "),e._UZ(4,"ion-icon",13),e.qZA()(),e.TgZ(5,"ion-col",11)(6,"ion-button",14),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2),s=o.$implicit,l=o.index,u=e.oxw();return e.KtG(u.eliminarHerramienta(s.idHerramienta,l))}),e._uU(7," eliminar "),e._UZ(8,"ion-icon",15),e.qZA()()()}}function H(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col",6)(2,"ion-button",16),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit,s=e.oxw();return e.KtG(s.agregar(o.nombre))}),e.TgZ(3,"ion-text",17)(4,"h6"),e._uU(5,"Agregar a pedidos"),e.qZA()()()()()}}function y(n,a){if(1&n&&(e.TgZ(0,"ion-card-content")(1,"ion-text",8)(2,"h2"),e._uU(3),e.qZA(),e.TgZ(4,"h2"),e._uU(5),e.qZA()(),e.TgZ(6,"ion-grid",2),e.YNc(7,S,9,0,"ion-row",9),e.qZA(),e.YNc(8,H,6,0,"ng-template",null,10,e.W1O),e.qZA()),2&n){const t=a.$implicit,i=e.MAs(9),o=e.oxw().$implicit;e.xp6(3),e.Oqu(o.nombre),e.xp6(2),e.hij("Cantidad: ",o.cantidad,""),e.xp6(2),e.Q6J("ngIf",2==t.idRolUsuario)("ngIfElse",i)}}function M(n,a){if(1&n&&(e.TgZ(0,"ion-col",5)(1,"ion-grid",2)(2,"ion-row")(3,"ion-col",6)(4,"ion-card")(5,"ion-card-header")(6,"ion-card-title"),e._uU(7,"Disponible"),e.qZA()(),e._UZ(8,"ion-img",7),e.YNc(9,y,10,4,"ion-card-content",4),e.qZA()()()()()),2&n){const t=a.$implicit,i=e.oxw();e.xp6(8),e.s9C("alt",t.nombre),e.Q6J("src",t.urlimagen),e.xp6(1),e.Q6J("ngForOf",i.usuario)}}function w(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"ion-fab",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.agregarHerramienta(o.idTaller))}),e.TgZ(1,"ion-fab-button",20),e._UZ(2,"ion-icon",21),e.qZA()()}}function I(n,a){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,w,3,0,"ion-fab",18),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("ngIf",2==t.idRolUsuario)}}let N=(()=>{class n{constructor(t,i,o,s,l,u,D,P){this.router=t,this.herramientaService=i,this.alert=o,this.toast=s,this.activatedRoute=l,this.userService=u,this.auth=D,this.userRol=P,this.carrito=new Array}ngOnInit(){null!=this.activatedRoute.snapshot.params.idTaller&&(this.idTaller=JSON.parse(this.activatedRoute.snapshot.params.idTaller)),this.auth.getUserLogged().subscribe(t=>{this.userService.getUserInfo(t.email).subscribe(i=>{this.usuario=i})})}ionViewWillEnter(){this.getList()}getList(){this.herramientaService.getHerramientasPorIdTaller(this.idTaller).subscribe(t=>{this.herramientasDelTaller=t})}agregarHerramienta(t){this.router.navigate(["layout/herramientas/agregar",{idTaller:JSON.stringify(t)}])}editarHerramienta(t){this.router.navigate(["layout/herramientas/agregar",{idHerramienta:JSON.stringify(t)}])}eliminarHerramienta(t,i){return(0,d.mG)(this,void 0,void 0,function*(){this.alert.presentAlertOptions("\xbfAceptas eliminar esta Herramienta?","Esta acci\xf3n no se puede revertir","danger",[{text:"Cancelar",handler:()=>{}},{text:"Aceptar",handler:()=>{this.herramientaService.deleteHerramienta(t).subscribe(()=>{this.toast.presentToast("herramienta eliminada","success",4e3),this.herramientasDelTaller.splice(i,1)})}}])})}agregar(t){this.carrito.push(t),this.toast.presentToast("Herramienta agregada","dark",4e3)}ver(){console.log(this.carrito)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.F0),e.Y36(v),e.Y36(Z),e.Y36(T.k),e.Y36(p.gz),e.Y36(A.K),e.Y36(C.e),e.Y36(x))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-listado"]],decls:10,vars:2,consts:[["slot","start"],["defaultHref","/layout"],["fixed",""],["sizeXs","12","sizeSm","6","sizeMd","4","sizeLg","4",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["sizeXs","12","sizeSm","6","sizeMd","4","sizeLg","4"],["size","12"],[3,"alt","src"],["color","dark"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["size","6"],["color","warning",3,"click"],["name","pencil-outline"],["color","danger",3,"click"],["name","trash-outline"],["color","light","shape","round","fill","clear","expand","block",3,"click"],["color","dark",1,"ion-text-lowercase"],["vertical","bottom","horizontal","end","slot","fixed",3,"click",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",3,"click"],["color","warning"],["name","add-outline"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-content")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Herramientas"),e.qZA(),e.TgZ(4,"ion-buttons",0),e._UZ(5,"ion-back-button",1),e.qZA()(),e.TgZ(6,"ion-grid",2)(7,"ion-row"),e.YNc(8,M,10,3,"ion-col",3),e.qZA()(),e.YNc(9,I,2,1,"div",4),e.qZA()),2&t&&(e.xp6(8),e.Q6J("ngForOf",i.herramientasDelTaller),e.xp6(1),e.Q6J("ngForOf",i.usuario))},dependencies:[g.sg,g.O5,r.oU,r.YG,r.Sm,r.PM,r.FN,r.Zi,r.Dq,r.wI,r.W2,r.IJ,r.W4,r.jY,r.gu,r.Xz,r.Nd,r.yW,r.wd,r.sr,r.cs],styles:["ion-card-header[_ngcontent-%COMP%]{--background: var(--ion-color-success-shade)}ion-card[_ngcontent-%COMP%]{--background: var(--ion-color-primary-shade);border-radius:20px}ion-fab-button[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{font-size:30px}ion-fab-button[_ngcontent-%COMP%]{margin:0 20px 20px 0}"]}),n})();class L{}var b=c(127);c(5428),b.Z.initializeApp(m.N.firebaseConfig);let U=(()=>{class n{constructor(){this.storageRef=b.Z.storage().ref()}subirImagen(t,i){return(0,d.mG)(this,void 0,void 0,function*(){try{return yield(yield this.storageRef.child(t).putString(i,"data_url")).ref.getDownloadURL()}catch(o){console.log(o)}})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),J=(()=>{class n{constructor(t){this.http=t,this.url=m.N.inventarioUTAPI+"marcas/"}getMarcas(){return this.http.get(this.url)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Y=(()=>{class n{constructor(t){this.loading=t}presentLoading(t,i){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.loading.create({message:t,spinner:"bubbles",cssClass:i})).present()})}stopLoading(){return(0,d.mG)(this,void 0,void 0,function*(){yield this.loading.dismiss()})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(r.HT))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var _=c(4182);function F(n,a){1&n&&(e.TgZ(0,"ion-title"),e._uU(1,"Agregar Herramienta"),e.qZA())}function z(n,a){1&n&&(e.TgZ(0,"ion-title"),e._uU(1,"Editar Herramienta"),e.qZA())}function k(n,a){if(1&n&&(e.TgZ(0,"div",15),e._UZ(1,"img",16),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("src",t.preview,e.LSH)}}function O(n,a){if(1&n&&(e.TgZ(0,"ion-select-option",17),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.idMarca),e.xp6(1),e.hij(" ",t.nombre," ")}}function R(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"ion-col",18)(1,"ion-button",19),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.addTool(o.herramienta))}),e._uU(2," Agregar "),e.qZA()()}}function q(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"ion-col",18)(1,"ion-button",20),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.ediTool(o.herramienta.idHerramienta,o.herramienta))}),e._uU(2," Editar "),e.qZA()()}}const G=[{path:"",children:[{path:"listado",component:N},{path:"agregar",component:(()=>{class n{constructor(t,i,o,s,l,u){this.activatedRoute=t,this.herramientaService=i,this.storageService=o,this.marcaService=s,this.loading=l,this.toast=u,this.herramienta=new L,this.reader=new FileReader}ngOnInit(){null!=this.activatedRoute.snapshot.params.idHerramienta?(this.herramientaService.getHerramienta(JSON.parse(this.activatedRoute.snapshot.params.idHerramienta)).subscribe(t=>{this.herramienta=t,this.preview=t.urlimagen}),this.editable=!0):(this.idTaller=JSON.parse(this.activatedRoute.snapshot.params.idTaller),this.editable=!1),this.marcaService.getMarcas().subscribe(t=>{this.brands=t})}ediTool(t,i){this.loading.presentLoading("Editando herramienta por favor espere...","primary"),null!=this.reader.result?this.storageService.subirImagen("Herramienta/"+Date.now().toString(),this.reader.result).then(o=>{i.urlimagen=o,this.herramientaService.putHerramienta(t,i).subscribe(()=>{this.loading.stopLoading(),this.toast.presentToast("Se modific\xf3 la herramienta exitosamente","success",4e3)},()=>{this.loading.stopLoading(),this.toast.presentToast("No se pudo editar la herramienta","danger",4e3)})}):this.herramientaService.putHerramienta(t,i).subscribe(()=>{this.loading.stopLoading(),this.toast.presentToast("Se modific\xf3 la herramienta exitosamente","success",4e3)},()=>{this.loading.stopLoading(),this.toast.presentToast("No se pudo editar la herramienta","danger",4e3)})}addTool(t){this.loading.presentLoading("Insertando herramienta, espere un segundo...","primary"),this.storageService.subirImagen("Herramienta/"+Date.now().toString(),this.reader.result).then(i=>{t.urlimagen=i,t.idEstatus=1,t.idTaller=this.idTaller,this.herramientaService.postHerramienta(t).subscribe(o=>{this.toast.presentToast("Exito, herramienta agregada","success",4e3),this.loading.stopLoading()},()=>{this.loading.stopLoading(),this.toast.presentToast("No se pudo agragar la herramienta","danger",4e3)})})}chargeImage(t){this.reader.readAsDataURL(t.target.files[0]),this.reader.onloadend=()=>{this.preview=this.reader.result.toString()}}clearImage(){this.preview=null}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.gz),e.Y36(v),e.Y36(U),e.Y36(J),e.Y36(Y),e.Y36(T.k))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-agregar"]],decls:31,vars:10,consts:[[3,"translucent"],["slot","start"],["defaultHref","/herramientas/listado"],[4,"ngIf"],["push-sm","2"],["size-xs","12","size-sm","8"],["position","floating"],["placeholder","Ingrega un nombre para la herramienta",3,"ngModel","ngModelChange"],["placeholder","Ingresa la cantidad de estas herramientas",3,"ngModel","ngModelChange"],["type","file","accept",".png, .jpg, .jpeg",1,"input-img",3,"change"],["class","img",4,"ngIf"],["interface","popover","placeholder","Selecciona una marca para la herramienta",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["push","2"],["size","4",4,"ngIf"],[1,"img"],["alt","","width","440px","height","330px",3,"src"],[3,"value"],["size","4"],["color","primary","expand","block","fill","outline","shape","round",3,"click"],["color","warning","expand","block","fill","outline","shape","round",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.YNc(4,F,2,0,"ion-title",3),e.YNc(5,z,2,0,"ion-title",3),e.qZA()(),e.TgZ(6,"ion-content")(7,"ion-grid")(8,"ion-row"),e._UZ(9,"ion-col",4),e.TgZ(10,"ion-col",5)(11,"ion-list")(12,"ion-item")(13,"ion-label",6),e._uU(14,"Nombre"),e.qZA(),e.TgZ(15,"ion-input",7),e.NdJ("ngModelChange",function(s){return i.herramienta.nombre=s}),e.qZA()(),e.TgZ(16,"ion-item")(17,"ion-label",6),e._uU(18,"Cantidad"),e.qZA(),e.TgZ(19,"ion-input",8),e.NdJ("ngModelChange",function(s){return i.herramienta.cantidad=s}),e.qZA()(),e.TgZ(20,"ion-input",9),e.NdJ("change",function(s){return i.chargeImage(s)}),e.qZA(),e.YNc(21,k,2,1,"div",10),e.TgZ(22,"ion-item")(23,"ion-select",11),e.NdJ("ngModelChange",function(s){return i.herramienta.idMarca=s}),e.YNc(24,O,2,2,"ion-select-option",12),e.qZA()(),e.TgZ(25,"ion-row"),e._UZ(26,"ion-col",13),e.YNc(27,R,3,0,"ion-col",14),e.YNc(28,q,3,0,"ion-col",14),e._UZ(29,"ion-col",13),e.qZA()()(),e._UZ(30,"ion-col",4),e.qZA()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("ngIf",!i.editable),e.xp6(1),e.Q6J("ngIf",i.editable),e.xp6(10),e.Q6J("ngModel",i.herramienta.nombre),e.xp6(4),e.Q6J("ngModel",i.herramienta.cantidad),e.xp6(2),e.Q6J("ngIf",i.preview),e.xp6(2),e.Q6J("ngModel",i.herramienta.idMarca),e.xp6(1),e.Q6J("ngForOf",i.brands),e.xp6(3),e.Q6J("ngIf",0==i.editable),e.xp6(1),e.Q6J("ngIf",1==i.editable))},dependencies:[g.sg,g.O5,_.JJ,_.On,r.oU,r.YG,r.Sm,r.wI,r.W2,r.jY,r.Gu,r.pK,r.Ie,r.Q$,r.q_,r.Nd,r.t9,r.n0,r.wd,r.sr,r.QI,r.j9,r.cs],styles:[".img[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}"]}),n})()},{path:"**",redirectTo:"listado"}]}];let Q=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[p.Bz.forChild(G)]}),n})(),E=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[g.ez,_.u5,r.Pc,Q]}),n})()}}]);